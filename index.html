<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Song Chords App</title>

<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0; padding: 0;
        background: #f4f4f4;
    }
    header {
        background: #6200ea;
        color: white;
        padding: 15px;
        text-align: center;
        font-size: 22px;
    }
    .container {
        padding: 20px;
        max-width: 900px;
        margin: auto;
    }
    textarea {
        width: 100%;
        height: 160px;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #ccc;
        resize: vertical;
        font-family: monospace;
        font-size: 15px;
    }
    #output {
        margin-top: 20px;
        background: white;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #ccc;
        white-space: pre-wrap;
        font-size: 17px;
    }
    .chord {
        font-weight: bold;
        color: #e91e63;
    }
    button, select {
        padding: 10px 14px;
        border: none;
        margin: 5px;
        border-radius: 6px;
        font-size: 15px;
        cursor: pointer;
    }
    button {
        background: #6200ea;
        color: white;
    }
    button:hover {
        background: #4a00c8;
    }
    /* SONG LIST */
    #songList {
        margin-top: 10px;
        background: white;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #ccc;
    }
    .songItem {
        padding: 10px;
        border-bottom: 1px solid #ddd;
        cursor: pointer;
    }
    .songItem:hover {
        background: #eeeeee;
    }
    /* CHORD DIAGRAMS */
    #diagrams {
        margin-top: 20px;
        padding: 10px;
        background: #fff;
        border-radius: 8px;
        border: 1px solid #ccc;
    }
    .diagram {
        display: inline-block;
        margin: 10px;
        text-align: center;
    }
</style>
</head>

<body>

<header>ðŸŽ¸ Song Chords App (Mobile + Chord Diagrams + Song List)</header>

<div class="container">

    <h3>Choose Song</h3>
    <div id="songList"></div>

    <h3>Edit or Paste Song</h3>
    <textarea id="songInput" placeholder="Paste chords like: [C] Hello [G] world"></textarea>

    <br>
    <label>Transpose:</label>
    <select id="transposeSelect">
        <option value="0">0 (Original)</option>
        <option value="-6">-6</option>
        <option value="-5">-5</option>
        <option value="-4">-4</option>
        <option value="-3">-3</option>
        <option value="-2">-2</option>
        <option value="-1">-1</option>
        <option value="1">+1</option>
        <option value="2">+2</option>
        <option value="3">+3</option>
        <option value="4">+4</option>
        <option value="5">+5</option>
        <option value="6">+6</option>
    </select>

    <button onclick="transpose(-1)">â–¼ -1</button>
    <button onclick="transpose(1)">â–² +1</button>
    <button onclick="renderSong()">Render</button>

    <div id="output"></div>

    <h3>Guitar Chord Diagrams</h3>
    <div id="diagrams"></div>

</div>

<script>
/* ---------------- SONG LIST (Editable) ---------------- */
const songs = {
    "Amazing Grace": "[C] Amazing grace how [F] sweet the [C] sound\nThat saved a wretch like [G] me",
    "Blessed Be Your Name": "[G] Blessed be Your [D] name\nIn the land that is [Em] plentiful",
    "10,000 Reasons": "[C] Bless the Lord oh my [G] soul\nOh my [D] soul"
};

const songListDiv = document.getElementById("songList");
Object.keys(songs).forEach(title => {
    let div = document.createElement("div");
    div.className = "songItem";
    div.innerText = title;
    div.onclick = () => {
        document.getElementById("songInput").value = songs[title];
        renderSong();
    };
    songListDiv.appendChild(div);
});

/* ---------------- CHORD TRANSPOSER ---------------- */
const sharpScale = ["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];
const flatScale  = ["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"];

function normalizeChord(chord) {
    if (chord.includes("b")) return flatScale.indexOf(chord);
    return sharpScale.indexOf(chord);
}

function transposeChord(chord, steps) {
    let base = chord.match(/[A-G][b#]?/);
    if (!base) return chord;
    let rest = chord.replace(base[0], "");
    let index = normalizeChord(base[0]);
    if (index < 0) return chord;
    let newIndex = (index + steps + 12) % 12;
    return sharpScale[newIndex] + rest;
}

function transpose(step) {
    let select = document.getElementById("transposeSelect");
    let value = parseInt(select.value);
    let newValue = value + step;
    if (newValue >= -6 && newValue <= 6) {
        select.value = newValue;
        renderSong();
    }
}

/* ---------------- RENDER SONG ---------------- */
function renderSong() {
    let input = document.getElementById("songInput").value;
    let steps = parseInt(document.getElementById("transposeSelect").value);

    let usedChords = new Set();

    let output = input.replace(/\[([A-G][b#]?(?:m|maj|min|sus|dim|aug|add)?\d*)\]/g, (match, chord) => {
        let t = transposeChord(chord, steps);
        usedChords.add(t);
        return `<span class='chord'>[${t}]</span>`;
    });

    document.getElementById("output").innerHTML = output;

    generateDiagrams([...usedChords]);
}

/* ---------------- CHORD DIAGRAMS ---------------- */
const chordShapes = {
    "C":  "x32010",
    "G":  "320003",
    "D":  "xx0232",
    "A":  "x02220",
    "E":  "022100",
    "F":  "133211",
    "Am": "x02210",
    "Em": "022000",
    "Dm": "xx0231"
};

function generateDiagrams(chords) {
    let box = document.getElementById("diagrams");
    box.innerHTML = "";

    chords.forEach(ch => {
        if (!chordShapes[ch]) return;

        let shape = chordShapes[ch].split("");

        let svg = `<svg width="80" height="120">
            <text x="40" y="15" font-size="16" text-anchor="middle">${ch}</text>
            <line x1="20" y1="30" x2="60" y2="30" stroke="black" stroke-width="2" />
            <line x1="20" y1="30" x2="20" y2="110" stroke="black"/>
            <line x1="40" y1="30" x2="40" y2="110" stroke="black"/>
            <line x1="60" y1="30" x2="60" y2="110" stroke="black"/>`;

        shape.forEach((fret, i) => {
            let x = 20 + i * 20;
            if (fret === "x") {
                svg += `<text x="${x}" y="25" font-size="12">x</text>`;
            } else if (fret === "0") {
                svg += `<text x="${x}" y="25" font-size="12">o</text>`;
            } else {
                let y = 30 + fret * 15;
                svg += `<circle cx="${x}" cy="${y}" r="6" fill="#6200ea"></circle>`;
            }
        });

        svg += "</svg>";

        let div = document.createElement("div");
        div.className = "diagram";
        div.innerHTML = svg;
        box.appendChild(div);
    });
}
</script>

</body>
</html>
